##### 逻辑表名

用户表根据用户id%2拆分为2个表，分别是：t_user_0和t_user_1。他们的逻辑表名是：t_user。

##### 分库分表数据节点

数据分片是最小单元。由数据源名称和数据表组成，比如：ds0.t_user_0。

##### 


##### 



#### ShardingJdbc的分库分表完整案例
用户数据存放在两个库中user_db_和user_db_1，每个库两张用户表：t_user_0，  t_user_1
按照id % 2决定将数据存放在哪个库， 再按照age % 2决定将数据存放在哪张表

1、数据库和表准备
```shell script
#创建两个数据库
create database user_db_0;
create database user_db_1;

#分别在每个数据库创建表结构相同的两个表t_user_x
CREATE TABLE t_user_0 (
    id INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT "用户编号",
    full_name VARCHAR(50) NOT NULL DEFAULT "" COMMENT "用户全名",
    age INT COMMENT "用户年龄"
) Engine=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE t_user_1 (
    id INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT "用户编号",
    full_name VARCHAR(50) NOT NULL DEFAULT "" COMMENT "用户全名",
    age INT COMMENT "用户年龄"
) Engine=InnoDB DEFAULT CHARSET=utf8;
```

2、引入相关依赖
```xml
<!--依赖sharding-->
<dependency>
    <groupId>org.apache.shardingsphere</groupId>
    <artifactId>sharding-jdbc-spring-boot-starter</artifactId>
    <version>4.1.1</version>
</dependency>

<dependency>
    <groupId>org.apache.shardingsphere</groupId>
    <artifactId>sharding-core-common</artifactId>
    <version>4.1.1</version>
</dependency>
```
3、配置文件
```yaml

server:
  port: 8888

spring:
  shardingsphere:
    #定义数据源：这里数据库拆分了两个，所以这里需要配置两个数据源。
    datasource:
      # 给每个数据源取别名，下面的ds1,ds1任意取名字
      names: ds0, ds1
      ds0:
        # 配置druid数据源
        type: com.alibaba.druid.pool.DruidDataSource
        driver-class-name: com.mysql.cj.jdbc.Driver
        url: jdbc:mysql://localhost:3306/user_db_0
        username: root
        password: 19870522
        maxPoolSize: 100
        minPoolSize: 5
      ds1:
        # 配置druid数据源
        type: com.alibaba.druid.pool.DruidDataSource
        driver-class-name: com.mysql.cj.jdbc.Driver
        url: jdbc:mysql://localhost:3306/user_db_1
        username: root
        password: 19870522
        maxPoolSize: 100
        minPoolSize: 5

    sharding:
      tables:
        #逻辑表名
        t_user:
          # 配置数据节点：多数据源$->{0..N}.逻辑表名$->{0..N} 相同表,  ${begin..end} 表示区间范围。
          # 逻辑表t_user对应的节点是：ds0.t_user_0, ds0.t_user_1, ds1.t_user_0, ds1.t_user_1
          actual-data-nodes: ds$->{0..1}.t_user_$->{0..1}
          # 拆分库策略，也就是什么样子的数据放入放到哪个数据库中。
          database-strategy:
            inline:
              sharding-column: id    # 分片字段（分片键）
              algorithm-expression: ds$->{id % 2} # 分片算法表达式
          # 拆分表策略，也就是什么样子的数据放入放到哪个数据表中。
          table-strategy:
            inline:
              sharding-column: age    # 分片字段（分片键）
              algorithm-expression: t_user_$->{age % 2} # 分片算法表达式


# 整合mybatis的配置XXXXX
mybatis:
  mapper-locations: classpath:com/qin/mapper/*.xml
  type-aliases-package: com.qin.entity
```


分库或分表策略定义方式如下：
#分库策略database‐strategy，如何将一个逻辑表映射到多个数据源 
spring.shardingsphere.sharding.tables.<逻辑表名称>.database‐strategy.<分片策略>.<分片策略属性名>= #分片策略属性值

#分表策略table‐strategy，如何将一个逻辑表映射为多个实际表 
spring.shardingsphere.sharding.tables.<逻辑表名称>.table‐strategy.<分片策略>.<分片策略属性名>= #分片策略属性值





4、编写测试程序